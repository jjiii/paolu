<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.fc.pay.boss.dao.BossRolePermissionMapper">
  <resultMap id="BaseResultMap" type="com.fc.pay.boss.entity.BossRolePermission" >
    <id column="id" property="id" jdbcType="BIGINT" />
    <result column="version" property="version" jdbcType="BIGINT" />
    <result column="creater" property="creater" jdbcType="VARCHAR" />
    <result column="create_time" property="createTime" jdbcType="TIMESTAMP" />
    <result column="editor" property="editor" jdbcType="VARCHAR" />
    <result column="edit_time" property="editTime" jdbcType="TIMESTAMP" />
    <result column="status" property="status" jdbcType="VARCHAR" />
    <result column="remark" property="remark" jdbcType="VARCHAR" />
    <result column="role_id" property="roleId" jdbcType="BIGINT" />
    <result column="permission_id" property="permissionId" jdbcType="BIGINT" />
  </resultMap>
  
  <!-- 通用查询结果列-->
  <sql id="Base_Column_List">
	id, version, creater, create_time AS createTime, editor, edit_time AS editTime, status, remark, role_id AS roleId, permission_id AS permissionId
  </sql>

		
	<!-- 批量插入分配的权限 -->
	<insert id="insertBatchRolePermission" parameterType="List">
		INSERT INTO boss_role_permission (creater,create_time,role_id,permission_id) VALUES
		<foreach collection ="list" item="menuPermission" index= "index" separator =",">
			(#{menuPermission.creater},
			#{menuPermission.createTime},
			#{menuPermission.roleId},
			#{menuPermission.permissionId})
        </foreach >
	</insert>
	
	<select id="selectCount" resultType="Integer" parameterType="java.lang.Long" >
		select count(1)
		from boss_role_permission
		<where>
			<if test="permissionId != null and permissionId != ''">
				and permission_id = #{permissionId}
			</if>
		</where>
	</select>		
	
	<!-- 查询角色下的权限ID -->
	<select id="selectListPermissionIds" parameterType="Long" resultType="Long">
		SELECT permission_id FROM boss_role_permission WHERE role_id = #{roleId}
	</select>
	
	<delete id="deleteBatchByRoleIdAndPermisId" parameterType="Map">
		DELETE FROM boss_role_permission WHERE role_id=#{roleId} AND permission_id IN
		<foreach item="permisId" collection="permisIds" open="(" separator="," close=")">  
        	#{permisId}  
        </foreach> 
	</delete>
	
	<delete id="deleteByMap" parameterType="Map" >
    	delete from boss_role_permission
		<where>
			<if test=" permissionId!=null and permissionId !='' ">
				and permission_id = #{permissionId}
			</if>
			<if test=" roleId!=null and roleId !='' ">
				and role_id = #{roleId}
			</if>
		</where>
 	</delete>	

</mapper>